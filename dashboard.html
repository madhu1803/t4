<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="../images/tvs_favicon.png">
    <link rel="icon" sizes="192x192" href="../images/tvs_favicon.png">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>TVS - T4 Inspection Monitoring Dashboard</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


    <!-- Bootstrap core CSS     -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.7.14/js/bootstrap-datetimepicker.min.js"></script>
    <!-- socket io - jquery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.7.14/css/bootstrap-datetimepicker.min.css">

    <div class="container">
        <div class="row">
            <div class='col-sm-6'>
                <div class="form-group">
                    <div class='input-group date' id='datetimepicker1'>
                        <input type='text' class="form-control" />
                        <span class="input-group-addon">
            <span class="glyphicon glyphicon-calendar"></span>
          </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Animation library for notifications   -->
    <link href="assets/css/animate.min.css" rel="stylesheet"/>

    <!--  Paper Dashboard core CSS    -->
    <link href="assets/css/paper-dashboard.css" rel="stylesheet"/>




    <!--  Fonts and icons     -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
    <link href="assets/css/themify-icons.css" rel="stylesheet">

    <link rel="stylesheet" href="assets/css/kendo/kendo.common.min.css" />
    <link rel="stylesheet" href="assets/css/kendo/kendo.default.min.css" />
    <link rel="stylesheet" href="assets/css/kendo/kendo.default.mobile.min.css" />
    <link href="assets/css/orbitron_font.css" rel="stylesheet">
    <style type="text/css">

        .gauge-value{
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8em;
            color: black;
            text-align: center;
            display: block;
            position: relative;
            bottom: 1em;
            font-family: Orbitron;
        }

        .smaller{
            bottom:1.5em;
        }

        h4.gauge-title{
            font-size:1.6em;
            color:black;

        }

        h4.gauge-title.smaller{
            position:relative;
            top:1em;
            font-size:1em;
            color:black;

        }

    </style>


</head>
<body>

<div class="wrapper">
    <div class="sidebar" data-background-color="white" data-active-color="danger">

    <!--
		Tip 1: you can change the color of the sidebar's background using: data-background-color="white | black"
		Tip 2: you can change the color of the active button using the data-active-color="primary | info | success | warning | danger"
	-->

    	<div class="sidebar-wrapper">
            <div class="logo">
                <a href="http://www.tvsmotor.com" class="simple-text">
                   <img src="../images/tvs-dashboard-logo.jpg" style="height:6.5em"/>
                </a>
            </div>

            <ul class="nav">
                <li class="active">
                    <a href="dashboard.html">
                        <i class="ti-panel" style="color:red"></i>
                        <p style="color:red">Dashboard</p>
                    </a>
                </li>
                <li>
                    <a href="user.html">
                        <i class="ti-user"></i>
                        <p>Vehicle Data</p>
                    </a>
                </li>

            </ul>
    	</div>
    </div>

    <div class="main-panel">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar bar1"></span>
                        <span class="icon-bar bar2"></span>
                        <span class="icon-bar bar3"></span>
                    </button>
                    <a class="navbar-brand" href="#">T4 Inspection Dashboard</a>



                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="ti-panel"></i>
								<p>Stats</p>
                            </a>
                        </li>
                        <li class="dropdown">
                              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="ti-bell"></i>
                                    <p class="notification">5</p>
									<p>Notifications</p>
									<b class="caret"></b>
                              </a>
                              <ul class="dropdown-menu">
                                <li><a href="#">Notification 1</a></li>
                                <li><a href="#">Notification 2</a></li>
                                <li><a href="#">Notification 3</a></li>
                                <li><a href="#">Notification 4</a></li>
                                <li><a href="#">Another notification</a></li>
                              </ul>
                        </li>
						<li>
                            <a href="#">
								<i class="ti-settings"></i>
								<p>Settings</p>
                            </a>
                        </li>
                    </ul>

                </div>
            </div>
        </nav>


        <div class="content">
            <div class="container-fluid">

                <div class="row">
                    <div class='col-sm-3'>
                    <div class="form-group">
                        <div class='input-group date' id='datetimepicker2'>
                            <input type='text' class="form-control" />
                            <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
            </span>
                        </div>
                    </div>
                </div>
                    <div class="col-md-3">
                        <label class="label-control">Select Shift</label>
                        <select class="form-control" id="selected-shift">
                            <option value="">Click to Select</option>
                            <option value="shift-1">Shift-1</option>
                            <option value="shift-2">Shift-2</option>

                        </select>

                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="content">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="icon-big icon-warning text-center">
                                            <i class="ti-dashboard"></i>
                                        </div>
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="numbers">
                                            <p>Total Vehicles Today -</p>
                                            535
                                        </div>
                                    </div>
                                </div>
                                <div class="footer">
                                    <hr />
                                    <div class="stats">
                                        <i class="ti-reload"></i> Updated now
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="content">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="icon-big icon-success text-center">
                                            <i class="ti-brush-alt"></i>
                                        </div>
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="numbers">
                                            <p>Total Vehicles Passed</p>
                                            134
                                        </div>
                                    </div>
                                </div>
                                <div class="footer">
                                    <hr />
                                    <div class="stats">
                                        <i class="ti-calendar"></i> Last day
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="content">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="icon-big icon-danger text-center">
                                            <i class="ti-pulse"></i>
                                        </div>
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="numbers">
                                            <p>Total Vehicles Defective</p>
                                            23
                                        </div>
                                    </div>
                                </div>
                                <div class="footer">
                                    <hr />
                                    <div class="stats">
                                        <i class="ti-timer"></i> In the last hour
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="content">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="icon-big icon-info text-center">
                                            <i class="ti-direction-alt"></i>
                                        </div>
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="numbers">
                                            <p>Total Vehicles Paint Defects</p>
                                            45
                                        </div>
                                    </div>
                                </div>
                                <div class="footer">
                                    <hr />
                                    <div class="stats">
                                        <i class="ti-reload"></i> Updated now
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">

                    <div class="col-md-4">

                        <div class="card">
                            <div class="header">
                                <h4 class="title">Total Rework Vehicles</h4>
                                <p class="category">24 Hours Data</p>
                            </div>


                            <div class="gauge-container" style="position:relative; top:1.8em;">
                                <div id="gauge-rework"></div>
                                <div id="gauge-rework-value" class="gauge-value smaller"></div>
                            </div>

                        </div>

                    </div>
                    <div class="col-md-8">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Real-Time Output - TVS, Plant-I</h4>
                                <p class="category">24 Hours performance</p>
                            </div>

                            <div id="defect-column-chart-container" style="height:17em;"></div>

                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Total Vehicle Defects</h4>
                                <p class="category">in the last 30 days</p>
                            </div>
                            <div class="content">
                                <div id="chartPreferences" class="ct-chart ct-perfect-fourth"></div>

                                <div class="footer">
                                    <div class="chart-legend">
                                        <i class="fa fa-circle text-info"></i> TVS Wego
                                        <i class="fa fa-circle text-danger"></i> TVS Jupiter
                                        <i class="fa fa-circle text-warning"></i> TVS XL 100
                                    </div>
                                    <hr>
                                    <div class="stats">
                                        <i class="ti-timer"></i> last report sent 2 days ago
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card ">
                            <div class="header">
                                <h4 class="title">T4 Inspection Vehicle Statistics</h4>
                                <p class="category">All Vehicles Through Plant-I Hosur</p>
                            </div>
                            <div class="content">
                                <div id="chartActivity" class="ct-chart"></div>

                                <div class="footer">
                                    <div class="chart-legend">
                                        <i class="fa fa-circle text-info"></i> TVS Jupiter
                                        <i class="fa fa-circle text-warning"></i> TVS Wego
                                    </div>
                                    <hr>
                                    <div class="stats">
                                        <i class="ti-check"></i> Machine Status: OK
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <footer class="footer">
            <div class="container-fluid">
                <nav class="pull-left">
                    <ul>

                        <li>
                            <a href="#">
                                Alphabt
                            </a>
                        </li>
                        <li>
                            <a href="#">
                               Blog
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                Licenses
                            </a>
                        </li>
                    </ul>
                </nav>
                <div class="copyright pull-right">
                    &copy; <script>document.write(new Date().getFullYear())</script>, made for <b>TVS</b> with <i class="fa fa-heart heart"></i> by <a href="#">alphabt</a>
                </div>
            </div>
        </footer>

    </div>
</div>


</body>

    <!--   Core JS Files   -->
    <!--<script src="https://code.jquery.com/jquery-3.3.1.min.js" type="text/javascript"></script>-->






<!--  Checkbox, Radio & Switch Plugins -->
	<!--<script src="assets/js/bootstrap-checkbox-radio.js"></script>-->



    <!--  Notifications Plugin    -->
    <script src="assets/js/bootstrap-notify.js"></script>

    <!--  Google Maps Plugin    -->

    <!-- Paper Dashboard Core javascript and methods for Demo purpose -->
	<script src="assets/js/paper-dashboard.js"></script>



    <!--<script src="assets/vendor/fusion-charts/js/fusioncharts.js"></script>-->
    <script src="https://cdn.fusioncharts.com/fusioncharts/latest/fusioncharts.js"></script>
    <script src="assets/scripts/kendo.all.min.js"></script>
    <script type="text/javascript" src="https://cdn.fusioncharts.com/fusioncharts/latest/themes/fusioncharts.theme.fusion.js"></script>
    <!--<script src="assets/vendor/fusion-charts/js/themes/fusioncharts.theme.fusion.js"></script>-->
    <!-- <script type="text/javascript">
            // init the socket
            var socket = io('http://localhost:5000');
            // if connected after init
        socket.on('connect', function () {
            console.log("socket connected!!!")
        });
// on `data_from_server` from server | render the chart
socket.on('data_from_server', function (data) {
            console.log("data got from server");
        $("#gauge-rework").kendoRadialGauge({

        pointer: {
            value: 35
        },

        scale: {
            minorUnit: 1,
            majorUnit:10,
            startAngle: -30,
            endAngle: 210,
            max: 100,
            labels: {
                position: "inside"
            },
            ranges: [
                {
                    from: 0,
                    to: 60,
                    color: "#c20000"
                }, {
                    from: 61,
                    to: 74,
                    color: "#ff7a00"
                }, {
                    from: 75,
                    to: 100,
                    color: "#00cc00"
                }
            ]
        }
        });
        
        gauge_rework_value = Math.floor(data);
        $("#gauge-rework").data("kendoRadialGauge").value(gauge_rework_value);
        $("#gauge-rework-value").text(gauge_rework_value+"%");

});
    </script> -->

    <script type="text/javascript">
//     function refreshData()
//     {
//         x = 60;  // 5 Seconds
//         $("#gauge-rework").kendoRadialGauge({

// pointer: {
//     value: 35
// },

// scale: {
//     minorUnit: 1,
//     majorUnit:10,
//     startAngle: -30,
//     endAngle: 210,
//     max: 100,
//     labels: {
//         position: "inside"
//     },
//     ranges: [
//         {
//             from: 0,
//             to: 60,
//             color: "#c20000"
//         }, {
//             from: 61,
//             to: 74,
//             color: "#ff7a00"
//         }, {
//             from: 75,
//             to: 100,
//             color: "#00cc00"
//         }
//     ]
// }
// });
// var request = $.ajax({
// url: "http://127.0.0.1:5000/getCount",
// type: "POST",
// dataType: "json"
// });

// request.done(function(msg) {
// console.log(JSON.stringify(request));
// value = request.responseJSON;
// gauge_rework_value = value;
// $("#gauge-rework").data("kendoRadialGauge").value(gauge_rework_value);
// $("#gauge-rework-value").text(gauge_rework_value+"%");

// //alert(msg);
// //value=msg;
// //alert(value);
// });
// request.fail(function(jqXHR, textStatus) {
// alert( "Request failed: " + textStatus );
// });
        
//         // Do your thing here

//         setTimeout(refreshData, x*1000);
//     }


    //refreshData(); // execute function
    	$(document).ready(function() {
            var socket = io('http://localhost:5000');
      // if connected after init
      var connected = false;
      const RETRY_INTERVAL = 10000;
      var timeout;

      socket.on("connect", function() {
        connected = true;
        clearTimeout(timeout);
        // socket.send({ subscribe: "schaftenaar" });
        // content.html("<b>Connected to server.</b>");
      });

      socket.on("disconnect", function() {
        connected = false;
        console.log("disconnected");
        // content.html(
        //   "<b>Disconnected! Trying to automatically to reconnect in " +
        //     RETRY_INTERVAL / 1000 +
        //     " seconds.</b>"
        // );
        retryConnectOnFailure(RETRY_INTERVAL);
      });

      var retryConnectOnFailure = function(retryInMilliseconds) {
        setTimeout(function() {
          if (!connected) {
            $.get("/ping", function(data) {
              connected = true;
              window.location.href = unescape(window.location.pathname);
            });
            retryConnectOnFailure(retryInMilliseconds);
          }
        }, retryInMilliseconds);
      };

      // start connection
      socket.connect();
      retryConnectOnFailure(RETRY_INTERVAL);

      // on `data_from_server` from server | render the chart
      socket.on("data_from_server", function(data) {
        console.log("data got from server");
        console.log(data);
        

        // render the chart
        const chartConfig = {
          type: "column2d",
          renderAt: "defect-column-chart-container",
          width: "100%",
          height: "200",
          dataFormat: "json",
          dataSource: {
            chart: {
              caption: "Defects",
              // subCaption: "In MMbbl = One Million barrels",
              xAxisName: "Defect Name",
              yAxisName: "Defect Value",
              numberSuffix: "",
              theme: "fusion"
            },
            data: JSON.parse(data) // convert json to javascript dict
          }
        };
        FusionCharts.ready(function() {
          var fusioncharts = new FusionCharts(chartConfig);
          fusioncharts.render();
        });
      });
      socket.on("gauge_data",function(data){
        console.log("Gauge Data");
        console.log(data);
        $("#gauge-rework").kendoRadialGauge({

        pointer: {
            value: 35
        },

        scale: {
            minorUnit: 1,
            majorUnit:10,
            startAngle: -30,
            endAngle: 210,
            max: 100,
            labels: {
                position: "inside"
            },
            ranges: [
                {
                    from: 0,
                    to: 60,
                    color: "#c20000"
                }, {
                    from: 61,
                    to: 74,
                    color: "#ff7a00"
                }, {
                    from: 75,
                    to: 100,
                    color: "#00cc00"
                }
            ]
        }
        });
        gauge_rework_value = data;
        $("#gauge-rework").data("kendoRadialGauge").value(gauge_rework_value);
        $("#gauge-rework-value").text(gauge_rework_value+"%");

      });



            $('#datetimepicker1').datetimepicker({
                format: 'YYYY-MM-DD HH:mm'
            });


        })







	</script>

</html>
